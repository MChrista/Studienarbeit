     1                                  ;-------------------------------------------------------------------
     2                                  ; FUNCTION:   int_to_hex
     3                                  ;
     4                                  ; PURPOSE:    Convert a 32-bit unsigned integer into its hexadecimal
     5                                  ;             ASCII representation
     6                                  ;
     7                                  ; PARAMETERS: (via register)
     8                                  ;             EAX - value to output as 32-bit unsigned integer
     9                                  ;             EDI - pointer to output string
    10                                  ;             ECX - number of digits
    11                                  ;
    12                                  ; RETURN:     none
    13                                  ;
    14                                  ;-------------------------------------------------------------------
    15                                  SECTION .data
    16                                  EXTERN hex_digits
    17                                  
    18                                  SECTION .text
    19                                  GLOBAL int_to_hex
    20                                  
    21                                  int_to_hex:
    22 00000000 53                              push    ebx             ; save used registers on stack
    23 00000001 51                              push    ecx
    24 00000002 52                              push    edx
    25                                  
    26                                  .loop:
    27 00000003 89C3                            mov     ebx,eax
    28 00000005 83E30F                          and     ebx,0xf
    29 00000008 8A93[00000000]                  mov     dl,[hex_digits+ebx]
    30 0000000E 88540FFF                        mov     [edi+ecx-1],dl
    31 00000012 C1C804                          ror     eax,4
    32 00000015 49                              dec     ecx
    33 00000016 75EB                            jnz     .loop
    34                                  
    35 00000018 5A                              pop     edx             ; restore registers from stack
    36 00000019 59                              pop     ecx
    37 0000001A 5B                              pop     ebx
    38 0000001B C3                              ret
    39                                  
