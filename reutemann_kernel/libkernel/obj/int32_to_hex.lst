     1                                  ;-------------------------------------------------------------------
     2                                  ; FUNCTION:   int32_to_hex
     3                                  ;
     4                                  ; PURPOSE:    Convert a 32-bit unsigned integer into its hexadecimal
     5                                  ;             ASCII representation
     6                                  ;
     7                                  ; PARAMETERS: (via register)
     8                                  ;             EAX - value to output as 32-bit unsigned integer
     9                                  ;             EDI - pointer to output string
    10                                  ;
    11                                  ; RETURN:     none
    12                                  ;
    13                                  ;-------------------------------------------------------------------
    14                                  SECTION .data
    15                                  EXTERN hex_digits
    16                                  
    17                                  SECTION .text
    18                                  GLOBAL int32_to_hex
    19                                  
    20                                  int32_to_hex:
    21 00000000 53                              push    ebx             ; save used registers on stack
    22 00000001 51                              push    ecx
    23 00000002 52                              push    edx
    24                                  
    25 00000003 B908000000                      mov     ecx,8           ; iterate over 8 hex digits
    26                                  .loop:
    27 00000008 89C3                            mov     ebx,eax
    28 0000000A 83E30F                          and     ebx,0xf
    29 0000000D 8A93[00000000]                  mov     dl,[hex_digits+ebx]
    30 00000013 88540FFF                        mov     [edi+ecx-1],dl
    31 00000017 C1C804                          ror     eax,4
    32 0000001A 49                              dec     ecx
    33 0000001B 75EB                            jnz     .loop
    34                                  
    35 0000001D 5A                              pop     edx             ; restore registers from stack
    36 0000001E 59                              pop     ecx
    37 0000001F 5B                              pop     ebx
    38 00000020 C3                              ret
    39                                  
